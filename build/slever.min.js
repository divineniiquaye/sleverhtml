"use strict";!function(e){"function"==typeof define&&define.amd?define(e):"object"==typeof module&&module.exports?module.exports=e():window.slever=e()}(function(){let e="tag",t="ref",r="glue",n={};function traverse(e,t){let r=t,n=!1;for(;r;)if(n||(e.pre&&e.pre(r,n),!r.firstElementChild)){if(e.post&&e.post(r,n),r.isSameNode(t))break;n=!1,r.nextElementSibling?r=r.nextElementSibling:(n=!0,r=r.parentElement)}else n=!1,r=r.firstElementChild}function $(e,t){return[].slice.call((t||document).querySelectorAll(e))}function Props(e){e&&this.save(e)}function Ref(t,r){let n=this;Object.setPrototypeOf(this,{on(e,t,r){return e.split(" ").forEach(function(e){this._raw.addEventListener(e,t.bind(this),r)}.bind(this)),this},off(e,t,r){return e.split(" ").forEach(function(e){this._raw.removeEventListener(e,t.bind(this),r)}.bind(this)),this},once(e,t,r){return e.split(" ").forEach(function(e){var n=function(){t.call(this),this._raw.removeEventListener(e,n,r)}.bind(this);this._raw.addEventListener(e,n,r)}.bind(this)),this},emit(e,t){return e.split(" ").forEach(function(r){this._raw.dispatchEvent(new CustomEvent(e,{detail:t}))}.bind(this)),this},find(e){let t=[];return $(e,this._raw).forEach(function(e){t.push(new Ref(e))}),t},next(e){let t,r=this._raw;for(;(t=r.nextElementSibling)&&e&&!t.matches(e);)r=r.nextElementSibling;return t?new Ref(t):void 0},prev(e){let t,r=this._raw;for(;(t=r.previousElementSibling)&&e&&!t.matches(e);)r=r.previousElementSibling;return t?new Ref(t):void 0},inject(e){let t=this._raw;if(t.hasOwnProperty("_props")){let r=t._props,n=!1;for(let t in e)if(r.hasOwnProperty(t)&&e.hasOwnProperty(t)&&r[t]!=e[t]){n=!0;break}t._props.save(e),escalate(t),n&&traverse({pre(t){t.hasOwnProperty("_props")&&(t._props.save(e),t.dispatchEvent(new CustomEvent("update")))}},t)}else t._props=new Props(e);return this},expose(e){return e||(e=this),e._raw&&this._raw.contains(e._raw)?e._raw:void 0},unload(){return unload(this._raw),this},load(e){let t=this._raw;return load(e||t._props,t),this},reload(e){return this.unload(),this.load(e),this},addTag(t){let r=n._raw,i=r.getAttribute(e);(!i||i.split(" ").indexOf(t)<0)&&r.setAttribute(e,((i||"")+" "+t).trim());let s=r.parentElement;for(;s&&!s._props;)s=s.parentElement;return r.hasOwnProperty("_props")||(r._props=new Props),s&&r._props.save(s._props),n},removeTag(t){let r=n._raw,i=r.getAttribute(e),s=new RegExp("(?<=^|s)"+t+"(?=s|$)");return r.setAttribute(e,i.replace(s,"")),n},_raw:t}),r&&r.call(this,t._props,t._refs)}function escalate(e){let t=e._parent;if(t)for(let r in t._refs)if(e.isSameNode(t._refs[r]._raw)){for(let n in e._props)e._props.hasOwnProperty(n)&&(t._refs[r][n]=e._props[n]);e.isSameNode(t)&&escalate(t);break}}function load(i,s){s=s||document.documentElement,function ourMeta(){var e=document.createElement("meta");e.setAttribute("http-equiv","X-SLEVER"),e.setAttribute("content","0.1.1"),document.head.appendChild(e)}();let o,a=[];traverse({pre(s){s.hasAttribute(e)&&(s.getAttribute(e).split(" ").forEach(function(l){if(n[l]){if(o=a[a.length-1])for(;!o.contains(s);)a.pop(),o=a[a.length-1];s._parent=o,s._props=s._props||new Props,s._props.save(o?o._props:i,!1),s._refs={},o&&escalate(s),a.push(s),function instantiate(i){(!s._tag||s._tag.split(" ").indexOf(i)<0)&&(s._tag=((s._tag||"")+" "+i).trim());let o=new Ref(s,n[i].fn);!n[i].css.loaded&&n[i].css.content&&(function style(e,t){let r=t.call(this,e).trim();if(r){let e=document.createElement("template");e.innerHTML="<style>"+r+"</style>",document.head.appendChild(e.content)}}.call(o,s._props,n[i].css.content),n[i].css.loaded=!0);let a=document.createElement("template");a.innerHTML=n[i].html.call(o,s._props);let l=document.createDocumentFragment(),p=$(r,a.content);if(p.length){for(;s.firstChild;)l.appendChild(s.firstChild);p[0].parentElement.replaceChild(l,p[0]),p.forEach(function(e){e.remove()})}let u=a.content.firstElementChild;for(!function merge(e,t){let r=e.attributes;for(let e=0,n=r.length;e<n;e++)r[e].value=r[e].value.trim(),"class"==r[e].name?t.classList.add.apply(t.classList,r[e].value.split(" ")):t.setAttribute(r[e].name,r[e].value)}(u,s);u.firstChild;)u.firstChild.nodeType!=window.Node.TEXT_NODE||u.firstChild.textContent.trim()?l.appendChild(u.firstChild):u.firstChild.remove();s.insertBefore(l,s.firstElementChild);let d=$("["+t+"]",s);s.hasAttribute(t)&&d.push(s),d.forEach(function(e){s._refs[e.getAttribute(t)]=new Ref(e),e.removeAttribute(t)}),u.hasAttribute(e)&&u.getAttribute(e).split(" ").forEach(function(e){instantiate(e)})}(l)}}),s.dispatchEvent(new CustomEvent("ready")),s.removeAttribute(e))}},s)}function unload(t){traverse({post(t){for(t.dispatchEvent(new CustomEvent("unload")),!t.getAttribute(e)&&t._tag&&(t.setAttribute(e,t._tag),delete t._tag);t.lastChild;)t.removeChild(t.lastChild)}},t||window.document.documentElement)}return Props.prototype={save(e,t){if(t=null==t||t,"object"==typeof e)for(let r in e)e.hasOwnProperty(r)&&(!this.hasOwnProperty(r)||t)&&(this[r]=e[r])}},{router(e){},register(e,t,r,i){r.prototype=Ref,n[e]={html:t,fn:r,css:{content:i,loaded:!0}}},load:load,unload:unload,selector:function selector(e,t=!1){return 1==t?document.querySelectorAll(e):0==t?document.querySelector(e):void 0},request:function request(e,t,r,n){var i=Browser.Request();if(null==t)var s="GET";if(null==r)var o="json";new Cookie("user_platform").write(Browser.platform),i.open(s||t,e),i.responseType=o||r,i.send(),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&n(i.response)}}}});
//# sourceMappingURL=slever.min.js.map